<IfModule mod_rewrite.c>
    RewriteEngine On

    # 1. ป้องกันการเข้าถึง hidden files และ dot files (เช่น .htaccess, .env, .git)
    RewriteRule (^|/)\. - [F,L]

    # 2. ป้องกันการเข้าถึง sensitive folders และ files โดยตรง
    #    (vendor, Core, App, storage, .env, composer.*, node_modules, .git)
    RewriteRule ^(vendor|Core|App|storage|\.env|composer\.json|composer\.lock|node_modules|\.git)(/|$) - [F,L]

    # 3. ป้องกัน directory listing (browsing) – วิธีมาตรฐานและดีที่สุด
    #    ใช้ Options -Indexes เพื่อให้ Apache แสดง 403 Forbidden ถ้าไม่มี index file
    Options -Indexes

    # 4. (Optional) ถ้าต้องการ block การเข้าถึง .php โดยตรง ยกเว้น index.php
    #    (ใน framework มักไม่จำเป็นเพราะทุก request ไป index.php อยู่แล้ว)
    # RewriteCond %{THE_REQUEST} \s/+.+?\.php[\s?] [NC]
    # RewriteCond %{REQUEST_URI} !^/index\.php$ [NC]
    # RewriteRule ^ - [F,L]

    # 5. Rewrite ทุก request ที่ไม่ใช่ไฟล์หรือโฟลเดอร์จริง → index.php (front controller)
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ index.php [QSA,L]
</IfModule>

# 6. Custom error pages (optional – แนะนำให้มี)
ErrorDocument 403 /Views/errors/403.php
ErrorDocument 404 /Views/errors/404.php
ErrorDocument 500 /Views/errors/500.php

# 7. เพิ่มความปลอดภัยพื้นฐานอื่น ๆ (แนะนำ)
# ป้องกันการเข้าถึง .htaccess เอง
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

# ป้องกันไฟล์ backup หรือ sensitive อื่น ๆ
<FilesMatch "\.(env|log|ini|bak|old|dist|git|svn|htaccess|htpasswd)$">
    Order allow,deny
    Deny from all
</FilesMatch>